Generate a complete ToolSpec for the following data analysis operation.

OPERATION: {operation}
REQUIRED COLUMNS: {required_columns}
GROUP BY: {group_by}
METRICS: {metrics}
FILTERS: {filters}
IMPLEMENTATION PLAN: {implementation_plan}
EDGE CASES: {edge_cases}
VALIDATION RULES: {validation_rules}

Create a ToolSpec with:
1. tool_name: A descriptive snake_case name based on operation and columns
2. description: Clear explanation of what this tool does
3. input_schema: JSON Schema for input parameters (file_path is required)
4. output_schema: JSON Schema for output structure (Dict with 'result' and 'metadata')
5. parameters: List of parameter definitions [{{"name": "file_path", "type": "str", "description": "Path to CSV file", "required": true}}]
6. when_to_use: When this tool should be selected
7. what_it_does: Technical description following the implementation plan
8. returns: Description of return value structure
9. prerequisites: String listing the exact required column names from REQUIRED COLUMNS in comma-separated format

Return JSON matching ToolSpec structure.
